<Window x:Class="ClipboardHistory.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Clipboard History"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ShowInTaskbar="False"
        Topmost="True"
        ResizeMode="NoResize"
        Deactivated="Window_Deactivated">

    <Window.Resources>
        <Storyboard x:Key="SlideIn">
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                           From="400" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
        </Storyboard>

        <Storyboard x:Key="SlideOut">
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                           From="0" To="400" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="1" To="0" Duration="0:0:0.15"/>
        </Storyboard>
    </Window.Resources>

    <Border Background="#1e1e1e" CornerRadius="8,0,0,8" BorderBrush="#3d3d3d" BorderThickness="1,1,0,1">
        <Border.RenderTransform>
            <TranslateTransform X="400"/>
        </Border.RenderTransform>
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.5"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Background="#2d2d2d" Padding="15,12">
                <Grid>
                    <TextBlock Text="Clipboard History"
                             FontSize="16"
                             FontWeight="SemiBold"
                             Foreground="White"
                             VerticalAlignment="Center"/>
                    <Button Content="&#xE8BB;"
                          FontFamily="Segoe MDL2 Assets"
                          FontSize="12"
                          HorizontalAlignment="Right"
                          Background="Transparent"
                          Foreground="#999"
                          BorderThickness="0"
                          Padding="8,4"
                          Cursor="Hand"
                          Click="ClearButton_Click"
                          ToolTip="Clear all history"/>
                </Grid>
            </Border>

            <!-- Search Box -->
            <Border Grid.Row="1" Padding="10,8">
                <TextBox x:Name="SearchBox"
                       Background="#2d2d2d"
                       Foreground="White"
                       BorderBrush="#3d3d3d"
                       BorderThickness="1"
                       Padding="10,8"
                       FontSize="13"
                       TextChanged="SearchBox_TextChanged">
                    <TextBox.Style>
                        <Style TargetType="TextBox">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TextBox">
                                        <Border Background="{TemplateBinding Background}"
                                              BorderBrush="{TemplateBinding BorderBrush}"
                                              BorderThickness="{TemplateBinding BorderThickness}"
                                              CornerRadius="4">
                                            <Grid>
                                                <TextBlock x:Name="Placeholder"
                                                         Text="Search clipboard history..."
                                                         Foreground="#666"
                                                         Padding="10,8"
                                                         FontSize="13"
                                                         Visibility="Collapsed"/>
                                                <ScrollViewer x:Name="PART_ContentHost" Margin="0"/>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="Text" Value="">
                                                <Setter TargetName="Placeholder" Property="Visibility" Value="Visible"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TextBox.Style>
                </TextBox>
            </Border>

            <!-- Clipboard Items List -->
            <ListBox x:Name="ClipboardList"
                   Grid.Row="2"
                   Background="Transparent"
                   BorderThickness="0"
                   ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                   ItemContainerStyle="{StaticResource ClipboardItemStyle}"
                   MouseDoubleClick="ClipboardList_MouseDoubleClick"
                   KeyDown="ClipboardList_KeyDown">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Image thumbnail (only visible for images) -->
                            <Border Grid.RowSpan="2"
                                    Margin="0,0,10,0"
                                    CornerRadius="4"
                                    Visibility="{Binding ImageVisibility}"
                                    Background="#2d2d2d">
                                <Image Source="{Binding ThumbnailSource}"
                                       Width="60" Height="45"
                                       Stretch="Uniform"/>
                            </Border>

                            <!-- Type icon for non-images -->
                            <TextBlock Grid.Column="0" Grid.RowSpan="2"
                                     Text="{Binding TypeIcon}"
                                     FontFamily="Segoe MDL2 Assets"
                                     FontSize="20"
                                     Foreground="#666"
                                     Margin="0,0,10,0"
                                     VerticalAlignment="Center"
                                     Visibility="{Binding IconVisibility}"/>

                            <TextBlock Grid.Column="1"
                                     Text="{Binding Preview}"
                                     TextTrimming="CharacterEllipsis"
                                     TextWrapping="NoWrap"
                                     FontSize="13"
                                     Foreground="#e0e0e0"/>
                            <TextBlock Grid.Column="1" Grid.Row="1"
                                     Text="{Binding TimeAgo}"
                                     FontSize="11"
                                     Foreground="#666"
                                     Margin="0,4,0,0"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

            <!-- Footer -->
            <Border Grid.Row="3" Background="#2d2d2d" Padding="12,10">
                <TextBlock Text="Double-click or Enter to copy • Scroll Lock to toggle • Esc to close"
                         FontSize="11"
                         Foreground="#666"
                         HorizontalAlignment="Center"/>
            </Border>
        </Grid>
    </Border>
</Window>
